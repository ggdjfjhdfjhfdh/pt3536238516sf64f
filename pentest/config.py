"""Configuración centralizada para el escáner de seguridad."""

import os
import re
from pathlib import Path

# Configuración de Redis
REDIS_URL = os.getenv("REDIS_URL", "redis://redis:6379/0")

# Validación de dominio
SAFE_DOMAIN = re.compile(r"^[a-z0-9.-]{3,253}$", re.I)

# Timeouts (en segundos)
DEFAULT_TIMEOUT = 300
TLS_SCAN_TIMEOUT = 60
HTTP_REQUEST_TIMEOUT = 10
HIBP_REQUEST_TIMEOUT = 10

# Rutas
TEMPLATES_DIR = Path(os.path.dirname(os.path.dirname(__file__))) / "templates"

# Configuración de User-Agent
USER_AGENT = "PentestExpress/2.0"

# Correos comunes para verificar filtraciones
def get_common_emails(domain: str) -> list[str]:
    """Genera una lista de correos comunes para el dominio."""
    return [
        f"info@{domain}", 
        f"contact@{domain}", 
        f"admin@{domain}",
        f"support@{domain}", 
        f"test@{domain}", 
        f"dev@{domain}",
        f"contacto@{domain}", 
        f"ventas@{domain}", 
        f"soporte@{domain}",
        f"ayuda@{domain}",
        f"webmaster@{domain}",
        f"security@{domain}",
        f"no-reply@{domain}",
        f"noreply@{domain}",
        f"sales@{domain}",
        f"marketing@{domain}",
    ]