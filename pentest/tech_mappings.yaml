# Configuración de mapeo de tecnologías a plantillas de análisis
# Este archivo define qué plantillas Nuclei y checks de seguridad usar para cada tecnología detectada

technology_templates:
  # === CMS (Content Management Systems) ===
  wordpress:
    nuclei_templates:
      - wordpress-detect
      - wordpress-version
      - wordpress-plugins
      - wordpress-themes
      - wordpress-config-backup
      - wordpress-admin-panel
      - wordpress-xmlrpc
      - wordpress-user-enum
      - wordpress-backup-files
      - wordpress-debug-log
      - wordpress-readme
      - wordpress-license
    security_checks:
      - wp_version_disclosure
      - wp_admin_access
      - wp_config_backup
      - wp_plugin_vulnerabilities
      - wp_theme_vulnerabilities
      - wp_xmlrpc_enabled
      - wp_user_enumeration
      - wp_debug_mode
      - wp_backup_files
      - wp_directory_listing
    categories:
      - cms
      - php
    priority: high

  drupal:
    nuclei_templates:
      - drupal-detect
      - drupal-version
      - drupal-modules
      - drupal-admin-panel
      - drupal-status-page
      - drupal-changelog
      - drupal-readme
    security_checks:
      - drupal_version_disclosure
      - drupal_admin_access
      - drupal_module_vulnerabilities
      - drupal_status_page_exposed
      - drupal_changelog_exposed
      - drupal_user_enumeration
    categories:
      - cms
      - php
    priority: high

  joomla:
    nuclei_templates:
      - joomla-detect
      - joomla-version
      - joomla-admin-panel
      - joomla-config-backup
      - joomla-readme
    security_checks:
      - joomla_version_disclosure
      - joomla_admin_access
      - joomla_config_backup
      - joomla_readme_exposed
    categories:
      - cms
      - php
    priority: high

  # === Servidores Web ===
  nginx:
    nuclei_templates:
      - nginx-version
      - nginx-status
      - nginx-alias-traversal
      - nginx-server-status
      - nginx-stub-status
    security_checks:
      - nginx_status_page
      - nginx_version_disclosure
      - nginx_alias_traversal
      - nginx_server_tokens
      - nginx_stub_status
    categories:
      - web-server
    priority: medium

  apache:
    nuclei_templates:
      - apache-version
      - apache-status
      - apache-server-info
      - apache-server-status
      - apache-httpd-info
    security_checks:
      - apache_status_page
      - apache_version_disclosure
      - apache_server_info
      - apache_server_tokens
      - apache_httpd_info
    categories:
      - web-server
    priority: medium

  iis:
    nuclei_templates:
      - iis-version
      - iis-shortname
      - iis-tilde-enum
    security_checks:
      - iis_version_disclosure
      - iis_shortname_vulnerability
      - iis_tilde_enumeration
    categories:
      - web-server
    priority: medium

  # === Frameworks JavaScript ===
  react:
    nuclei_templates:
      - react-detect
      - react-dev-tools
      - react-source-maps
      - react-debug-info
    security_checks:
      - react_dev_mode
      - react_source_maps_exposed
      - react_debug_info
      - react_profiler_enabled
    categories:
      - javascript-framework
      - frontend
    priority: low

  vue.js:
    nuclei_templates:
      - vue-detect
      - vue-dev-tools
      - vue-source-maps
      - vue-debug-info
    security_checks:
      - vue_dev_mode
      - vue_source_maps_exposed
      - vue_debug_info
      - vue_devtools_enabled
    categories:
      - javascript-framework
      - frontend
    priority: low

  angular:
    nuclei_templates:
      - angular-detect
      - angular-version
      - angular-source-maps
      - angular-debug-info
    security_checks:
      - angular_dev_mode
      - angular_source_maps_exposed
      - angular_debug_info
      - angular_profiler_enabled
    categories:
      - javascript-framework
      - frontend
    priority: low

  # === Frameworks Backend ===
  laravel:
    nuclei_templates:
      - laravel-detect
      - laravel-debug
      - laravel-env
      - laravel-telescope
      - laravel-horizon
      - laravel-log-viewer
    security_checks:
      - laravel_debug_mode
      - laravel_env_exposed
      - laravel_telescope_exposed
      - laravel_log_files
      - laravel_horizon_exposed
      - laravel_config_cache
    categories:
      - php-framework
      - backend
    priority: high

  django:
    nuclei_templates:
      - django-detect
      - django-debug
      - django-admin
      - django-secret-key
    security_checks:
      - django_debug_mode
      - django_admin_panel
      - django_secret_key_exposure
      - django_settings_exposed
    categories:
      - python-framework
      - backend
    priority: high

  flask:
    nuclei_templates:
      - flask-detect
      - flask-debug
      - flask-config
    security_checks:
      - flask_debug_mode
      - flask_config_exposed
      - flask_secret_key_weak
    categories:
      - python-framework
      - backend
    priority: medium

  spring:
    nuclei_templates:
      - spring-boot-actuator
      - spring-boot-info
      - spring-boot-health
    security_checks:
      - spring_actuator_exposed
      - spring_info_exposed
      - spring_health_exposed
      - spring_env_exposed
    categories:
      - java-framework
      - backend
    priority: high

  # === Bases de Datos ===
  mysql:
    nuclei_templates:
      - mysql-detect
      - mysql-version
      - mysql-default-creds
    security_checks:
      - mysql_version_disclosure
      - mysql_default_credentials
      - mysql_anonymous_access
    categories:
      - database
    priority: high

  postgresql:
    nuclei_templates:
      - postgresql-detect
      - postgresql-version
      - postgresql-default-creds
    security_checks:
      - postgresql_version_disclosure
      - postgresql_default_credentials
    categories:
      - database
    priority: high

  mongodb:
    nuclei_templates:
      - mongodb-detect
      - mongodb-unauth
    security_checks:
      - mongodb_unauthorized_access
      - mongodb_default_credentials
    categories:
      - database
      - nosql
    priority: high

  redis:
    nuclei_templates:
      - redis-detect
      - redis-unauth
    security_checks:
      - redis_unauthorized_access
      - redis_default_config
    categories:
      - database
      - cache
    priority: high

  # === Tecnologías de Contenido ===
  jquery:
    nuclei_templates:
      - jquery-version
      - jquery-vulnerabilities
    security_checks:
      - jquery_version_check
      - jquery_known_vulnerabilities
    categories:
      - javascript-library
      - frontend
    priority: low

  bootstrap:
    nuclei_templates:
      - bootstrap-version
    security_checks:
      - bootstrap_version_check
    categories:
      - css-framework
      - frontend
    priority: low

  # === Lenguajes de Programación ===
  php:
    nuclei_templates:
      - php-version
      - php-info
      - php-errors
    security_checks:
      - php_version_disclosure
      - php_info_exposed
      - php_errors_exposed
      - php_session_config
    categories:
      - programming-language
      - backend
    priority: medium

  python:
    nuclei_templates:
      - python-version
      - python-debug
    security_checks:
      - python_version_disclosure
      - python_debug_mode
    categories:
      - programming-language
      - backend
    priority: medium

  # === Servicios Cloud ===
  aws:
    nuclei_templates:
      - aws-s3-bucket
      - aws-metadata
    security_checks:
      - aws_s3_public_bucket
      - aws_metadata_exposed
    categories:
      - cloud-service
    priority: high

  azure:
    nuclei_templates:
      - azure-metadata
    security_checks:
      - azure_metadata_exposed
    categories:
      - cloud-service
    priority: high

  # === Herramientas de Desarrollo ===
  git:
    nuclei_templates:
      - git-config
      - git-folder
    security_checks:
      - git_folder_exposed
      - git_config_exposed
    categories:
      - development-tool
    priority: high

  docker:
    nuclei_templates:
      - docker-api
      - docker-registry
    security_checks:
      - docker_api_exposed
      - docker_registry_exposed
    categories:
      - containerization
    priority: high

  # === APIs y Servicios ===
  graphql:
    nuclei_templates:
      - graphql-introspection
      - graphql-playground
    security_checks:
      - graphql_introspection_enabled
      - graphql_playground_exposed
    categories:
      - api
    priority: medium

  swagger:
    nuclei_templates:
      - swagger-ui
      - swagger-json
    security_checks:
      - swagger_ui_exposed
      - swagger_json_exposed
    categories:
      - api
      - documentation
    priority: medium

# Configuración de headers de seguridad
security_headers:
  required_headers:
    - X-Frame-Options
    - X-Content-Type-Options
    - X-XSS-Protection
    - Strict-Transport-Security
    - Content-Security-Policy
    - Referrer-Policy
    - Permissions-Policy
  
  technology_specific:
    php:
      headers_to_check:
        - X-Powered-By
      should_be_hidden: true
      description: "PHP no debería exponer información de versión"
    
    nginx:
      headers_to_check:
        - Server
      should_contain_version: false
      description: "Nginx no debería mostrar información de versión"
    
    apache:
      headers_to_check:
        - Server
      should_contain_version: false
      description: "Apache no debería mostrar información de versión"
    
    iis:
      headers_to_check:
        - Server
      should_contain_version: false
      description: "IIS no debería mostrar información de versión"

# Umbrales de confianza para filtrar tecnologías
confidence_thresholds:
  high: 80      # Tecnologías con alta confianza
  medium: 60    # Tecnologías con confianza media
  low: 40       # Tecnologías con baja confianza
  minimum: 30   # Umbral mínimo para considerar una tecnología

# Configuración de prioridades para el análisis
analysis_priorities:
  high:
    - cms
    - database
    - cloud-service
    - development-tool
    - containerization
  medium:
    - web-server
    - backend-framework
    - api
    - programming-language
  low:
    - frontend
    - javascript-framework
    - javascript-library
    - css-framework

# Configuración de timeouts por tipo de tecnología
timeouts:
  default: 30
  database: 45
  cloud-service: 60
  cms: 40
  web-server: 25

# Mapeo de vulnerabilidades conocidas por tecnología
vulnerability_mappings:
  wordpress:
    common_vulnerabilities:
      - wp_user_enumeration
      - wp_xmlrpc_pingback
      - wp_config_backup
      - wp_admin_brute_force
      - wp_plugin_vulnerabilities
    version_specific:
      "< 6.0":
        - wp_block_editor_xss
      "< 5.8":
        - wp_media_library_xss
      "< 5.0":
        - wp_gutenberg_xss
      "< 4.9":
        - wp_rest_api_exposure
      "< 4.7":
        - wp_rest_api_user_enum
  
  drupal:
    common_vulnerabilities:
      - drupal_user_enumeration
      - drupal_status_page
      - drupal_admin_brute_force
    version_specific:
      "< 9.3":
        - drupal_rce_sa_core_2022_002
      "< 8.6":
        - drupal_rce_sa_core_2018_007
      "< 7.58":
        - drupal_rce_drupalgeddon2
  
  joomla:
    common_vulnerabilities:
      - joomla_config_backup
      - joomla_admin_brute_force
    version_specific:
      "< 4.0":
        - joomla_rce_cve_2021_23132
      "< 3.9":
        - joomla_rce_cve_2019_10945
  
  laravel:
    common_vulnerabilities:
      - laravel_debug_mode
      - laravel_env_exposed
    version_specific:
      "< 8.0":
        - laravel_rce_cve_2021_3129
  
  django:
    common_vulnerabilities:
      - django_debug_mode
      - django_admin_panel
    version_specific:
      "< 3.2":
        - django_path_traversal_cve_2021_28658

# Configuración de reportes
reporting:
  include_low_confidence: false
  group_by_category: true
  show_version_info: true
  include_recommendations: true
  max_technologies_per_report: 50

# Configuración de cache
cache:
  enabled: true
  ttl_hours: 24
  max_entries: 1000
  cleanup_interval_hours: 6